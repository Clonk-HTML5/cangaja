<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>js&#x2F;demo-box2d-3.js - Cangaja API</title>
    <link rel="stylesheet" href="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;3.8.0&#x2F;build&#x2F;cssgrids&#x2F;cssgrids-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="..&#x2F;assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="..&#x2F;assets/favicon.png">
    <script src="http:&#x2F;&#x2F;yui.yahooapis.com&#x2F;combo?3.8.0&#x2F;build&#x2F;yui&#x2F;yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="..&#x2F;assets/css/logo.png" title="Cangaja API"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.0.0</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="..&#x2F;classes/CG.Animation.html">CG.Animation</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DBridge.html">CG.B2DBridge</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DCirlce.html">CG.B2DCirlce</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DEntity.html">CG.B2DEntity</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DLine.html">CG.B2DLine</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DPolygon.html">CG.B2DPolygon</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DRectangle.html">CG.B2DRectangle</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DRope.html">CG.B2DRope</a></li>
            
                <li><a href="..&#x2F;classes/CG.B2DWorld.html">CG.B2DWorld</a></li>
            
                <li><a href="..&#x2F;classes/CG.Bitmap.html">CG.Bitmap</a></li>
            
                <li><a href="..&#x2F;classes/CG.Bound.html">CG.Bound</a></li>
            
                <li><a href="..&#x2F;classes/CG.Buffer.html">CG.Buffer</a></li>
            
                <li><a href="..&#x2F;classes/CG.Button.html">CG.Button</a></li>
            
                <li><a href="..&#x2F;classes/CG.CanvasRenderer.html">CG.CanvasRenderer</a></li>
            
                <li><a href="..&#x2F;classes/CG.Delta.html">CG.Delta</a></li>
            
                <li><a href="..&#x2F;classes/CG.Director.html">CG.Director</a></li>
            
                <li><a href="..&#x2F;classes/CG.Emitter.html">CG.Emitter</a></li>
            
                <li><a href="..&#x2F;classes/CG.Entity.html">CG.Entity</a></li>
            
                <li><a href="..&#x2F;classes/CG.Font.html">CG.Font</a></li>
            
                <li><a href="..&#x2F;classes/CG.Layer.html">CG.Layer</a></li>
            
                <li><a href="..&#x2F;classes/CG.Map.html">CG.Map</a></li>
            
                <li><a href="..&#x2F;classes/CG.MapArea.html">CG.MapArea</a></li>
            
                <li><a href="..&#x2F;classes/CG.MapPoint.html">CG.MapPoint</a></li>
            
                <li><a href="..&#x2F;classes/CG.MapTileLayer.html">CG.MapTileLayer</a></li>
            
                <li><a href="..&#x2F;classes/CG.MapTileProperties.html">CG.MapTileProperties</a></li>
            
                <li><a href="..&#x2F;classes/CG.MediaAsset.html">CG.MediaAsset</a></li>
            
                <li><a href="..&#x2F;classes/CG.Menu.html">CG.Menu</a></li>
            
                <li><a href="..&#x2F;classes/CG.Morph.html">CG.Morph</a></li>
            
                <li><a href="..&#x2F;classes/CG.Particle.html">CG.Particle</a></li>
            
                <li><a href="..&#x2F;classes/CG.Point.html">CG.Point</a></li>
            
                <li><a href="..&#x2F;classes/CG.Rectangle.html">CG.Rectangle</a></li>
            
                <li><a href="..&#x2F;classes/CG.Screen.html">CG.Screen</a></li>
            
                <li><a href="..&#x2F;classes/CG.Sequence.html">CG.Sequence</a></li>
            
                <li><a href="..&#x2F;classes/CG.Sprite.html">CG.Sprite</a></li>
            
                <li><a href="..&#x2F;classes/CG.TexturePacker.html">CG.TexturePacker</a></li>
            
                <li><a href="..&#x2F;classes/CG.TPImage.html">CG.TPImage</a></li>
            
                <li><a href="..&#x2F;classes/CG.Translate.html">CG.Translate</a></li>
            
                <li><a href="..&#x2F;classes/CG.Vector.html">CG.Vector</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="..&#x2F;modules/CG.html">CG</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: js&#x2F;demo-box2d-3.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
var renderStats, updateStats

var mainscreen, mainlayer

var can, canvas, ctx
var sfxWhistle,sfxCrowd,sfxNet,sfxIntro

var rightplayer, leftplayer, ball
var startleft = false, startright = true

var mousex = 0
var mousey = 0
var mousedown = false
var tp = new CG.TexturePacker()
var collision = {direction: &#x27;&#x27;, overlap: 0}

var gw = 800, gh = 480


&#x2F;&#x2F;waiting to get started ;o)
window.onload = function () {

    &#x2F;&#x2F;create canvas element programaticaly
    can = document.createElement(&#x27;canvas&#x27;)
    can.width = gw
    can.height = gh
    can.id = &#x27;canvas&#x27;
    document.body.appendChild(can)

    &#x2F;&#x2F;mouse move


    can.addEventListener(&quot;mousedown&quot;, function (e) {
        mousedown = true;
    }, true);

    can.addEventListener(&quot;mouseup&quot;, function () {
        mousedown = false;
    }, true);

    can.addEventListener(&#x27;mousemove&#x27;, function (evt) {
        var rect = can.getBoundingClientRect(), root = document.documentElement;
        mousex = evt.clientX - canvas.offsetLeft;
        mousey = evt.clientY - canvas.offsetTop;
    }, false);

    Game.preload()
};

&#x2F;**
 * extend B2DWorld and create own objects in the constructor.
 *&#x2F;
CG.B2DWorld.extend(&#x27;B2DTestbed&#x27;, {
    init: function (name, opt) {
        this._super(name, opt)
        this.debug = 0

        this.addCustom(new CG.B2DBlobbyWall(this.world, &#x27;L&#x27;, new CG.Point(0, -400), new CG.Point(0, Game.height), this.scale))
        this.addCustom(new CG.B2DBlobbyWall(this.world, &#x27;R&#x27;, new CG.Point(Game.width, -400), new CG.Point(Game.width, Game.height), this.scale))
        this.addCustom(new CG.B2DBlobbyGround(this.world, &#x27;G&#x27;, new CG.Point(0, Game.height - 50), new CG.Point(Game.width, Game.height - 50), this.scale))
        this.addCustom(new CG.B2DBlobbyWall(this.world, &#x27;N&#x27;, new CG.Point(Game.width2 - 10, Game.height2 - 43), new CG.Point(Game.width2 - 10, Game.height), this.scale))
        this.addCustom(new CG.B2DBlobbyWall(this.world, &#x27;N&#x27;, new CG.Point(Game.width2, Game.height2 - 51), new CG.Point(Game.width2, Game.height), this.scale))
        this.addCustom(new CG.B2DBlobbyWall(this.world, &#x27;N&#x27;, new CG.Point(Game.width2 + 10, Game.height2 - 43), new CG.Point(Game.width2 + 10, Game.height), this.scale))

        ball = new CG.B2DBall(this.world, &#x27;beachvolleyball&#x27;, Game.asset.getImageByName(&#x27;beachvolleyball&#x27;), 75, 310, -200, this.scale, false)
        this.addCustom(ball)

        rightplayer = new CG.B2DRightPlayer(this.world, &#x27;blobby-egg-right&#x27;, Game.asset.getImageByName(&#x27;blobby-egg-right&#x27;), Game.asset.getJsonByName(&#x27;blobbies&#x27;), Game.width - 175, 230, this.scale, false, false)
        this.addCustom(rightplayer)
        leftplayer = new CG.B2DLeftPlayer(this.world, &#x27;blobby-egg-left&#x27;, Game.asset.getImageByName(&#x27;blobby-egg-left&#x27;), Game.asset.getJsonByName(&#x27;blobbies&#x27;), 50, 230, this.scale, false, false)
        this.addCustom(leftplayer)

        this.addContactListener({
            BeginContact: function (idA, idB) {
                if ((idA.name == &#x27;blobby-egg-left&#x27; || idA.name == &#x27;blobby-egg-right&#x27;) &amp;&amp; idB.name == &quot;beachvolleyball&quot;) {
                    startleft = startright = false
                }
                &#x2F;&#x2F;beachvolleyball hits the ground
                if (idA.name == &#x27;G&#x27; &amp;&amp; idB.name == &quot;beachvolleyball&quot;) {
                    if(ball.body.GetPosition().x * 40 &gt; 400){
                        startleft = true
                    } else {
                        startright = true
                    }
                    sfxWhistle.play()
                    sfxCrowd.play()
                }
                &#x2F;&#x2F;ball hits net
                if (idA.name == &#x27;N&#x27; &amp;&amp; idB.name == &quot;beachvolleyball&quot;) {
                    sfxNet.play()
                }

                &#x2F;&#x2F;players are landing on ground, set jump flag to false
                if ((idA.name == &#x27;blobby-egg-left&#x27; || idA.name == &#x27;blobby-egg-right&#x27;) &amp;&amp; idB.name == &quot;G&quot;) {
                    b2world.elements[idA.uid - 1].jump = false
                }

                &#x2F;&#x2F;players contact with beachvolleyball
                if ((idA.name == &#x27;blobby-egg-left&#x27; || idA.name == &#x27;blobby-egg-right&#x27;) &amp;&amp; idB.name == &quot;beachvolleyball&quot;) {
                    &#x2F;&#x2F;console.log([&#x27;PostSolve&#x27;, idA, idB, impulse]);
                    b2world.elements[idA.uid - 1].points += 1
                    if (idA.name == &#x27;blobby-egg-right&#x27;) {
                        leftplayer.points = 0
                        if (rightplayer.points &gt; 4) {
                            &#x2F;&#x2F;alert(&#x27;rightplayer lost to much contacts&#x27;)
                        }
                    } else if (idA.name == &#x27;blobby-egg-left&#x27;) {
                        rightplayer.points = 0
                        if (leftplayer.points &gt; 4) {
                            &#x2F;&#x2F;alert(&#x27;leftplayer lost to much contacts&#x27;)
                        }
                    }
                }
            },

            PostSolve: function (idA, idB, impulse) {

&#x2F;&#x2F;                    var entityA = world[idA];
&#x2F;&#x2F;                    var entityB = world[idB];
            }
        });

    }
})

&#x2F;**
 * extend B2DLine and define&#x2F;overwrite custom bodyDef and fixDef in constructor
 *&#x2F;
CG.B2DLine.extend(&#x27;B2DBlobbyWall&#x27;, {
    init: function (world, name, start, end, scale) {
        this.bodyDef = new b2BodyDef &#x2F;&#x2F;&#x27;overwrite&#x27; class bodyDef
        this.bodyDef.allowSleep = true
        this.bodyDef.awake = false

        this.fixDef = new b2FixtureDef &#x2F;&#x2F;&#x27;overwrite&#x27; class fixDef
        this.fixDef.density = 1.0
        this.fixDef.friction = 0.5
        this.fixDef.restitution = 0.5

        this._super(world, name, new b2Vec2(start.x &#x2F; scale, start.y &#x2F; scale), new b2Vec2(end.x &#x2F; scale, end.y &#x2F; scale), scale)
    }
})

&#x2F;**
 * extend B2DLine and define&#x2F;overwrite bodyDef and fixDef in constructor
 *&#x2F;
CG.B2DLine.extend(&#x27;B2DBlobbyGround&#x27;, {
    init: function (world, name, start, end, scale) {
        this.bodyDef = new b2BodyDef &#x2F;&#x2F;&#x27;overwrite&#x27; class bodyDef
        this.bodyDef.allowSleep = true
        this.bodyDef.awake = false

        this.fixDef = new b2FixtureDef &#x2F;&#x2F;&#x27;overwrite&#x27; class fixDef
        this.fixDef.density = 1.0
        this.fixDef.friction = 0.2
        this.fixDef.restitution = 0.2

        this._super(world, name, new b2Vec2(start.x &#x2F; scale, start.y &#x2F; scale), new b2Vec2(end.x &#x2F; scale, end.y &#x2F; scale), scale)
    }
})

&#x2F;**
 * extend B2DPolygon and define own bodyDef&#x2F;fixDef and some additional properties&#x2F;methods
 *&#x2F;
CG.B2DPolygon.extend(&#x27;B2DPlayer&#x27;, {
    init: function (world, name, image, jsonpoly, x, y, scale, stat, bullet) {

        this.bodyDef = new b2BodyDef
        this.bodyDef.fixedRotation = true
        this.bodyDef.allowSleep = false
        this.bodyDef.bullet = true

        this.fixDef = new b2FixtureDef
        this.fixDef.restitution = 0.1
        this.linearDamping = 0
        this.angularDamping = 0

        this.jump = false
        this.max_hor_vel = 11
        this.max_ver_vel = 11

        this.points = 0
        this.offhor = 20
        this.offver = 20

        this.font = new CG.Font().loadFont(Game.asset.getFontByName(&#x27;blobby-points&#x27;))

        this.ballcontacts = 0

        this._super(world, name, image, jsonpoly, x, y, scale, stat, bullet)
    },
    addVelocity: function (vel) {
        var v = this.body.GetLinearVelocity();

        v.Add(vel);

        &#x2F;&#x2F;check for max horizontal and vertical velocities and then set
        if (Math.abs(v.y) &gt; this.max_ver_vel) {
            v.y = this.max_ver_vel * v.y &#x2F; Math.abs(v.y);
        }

        if (Math.abs(v.x) &gt; this.max_hor_vel) {
            v.x = this.max_hor_vel * v.x &#x2F; Math.abs(v.x);
        }

        &#x2F;&#x2F;set the new velocity
        this.body.SetLinearVelocity(v);

&#x2F;&#x2F;        if (vel.y &lt; 0) {
&#x2F;&#x2F;            this.jump = true
&#x2F;&#x2F;        }
    },
    applyImpulse: function (degrees, power) {
        if (this.body) {
            this.body.ApplyImpulse(new b2Vec2(Math.cos(degrees * (Math.PI &#x2F; 180)) * power,
                Math.sin(degrees * (Math.PI &#x2F; 180)) * power),
                this.body.GetWorldCenter());
        }
    }
})

&#x2F;**
 * extend B2DPlayer with additional font drawing
 *&#x2F;
CG.B2DPlayer.extend(&#x27;B2DRightPlayer&#x27;, {
    init: function (world, name, image, jsonpoly, x, y, scale, stat, bullet) {
        this._super(world, name, image, jsonpoly, x, y, scale, stat, bullet)

        this.shadow = new CG.Sprite(Game.asset.getImageByName(&#x27;beachvolleyball-shadow&#x27;), new CG.Point((this.body.GetPosition().x + 58) * this.scale, Game.height - 50))
        this.shadow.xscale = 1.3
        this.shadow.name = &#x27;beachvolleyball-shadow&#x27;
        mainlayer.addElement(this.shadow)

    },
    draw: function () {
        this._super()
        this.font.draw(&#x27;&#x27; + this.points, Game.width - this.offhor - this.font.getTextWidth(&#x27;&#x27; + this.points), this.offver)

    },
    update: function () {
        this._super()
        this.shadow.position.x = (this.body.GetPosition().x + 1.45) * this.scale
    }
})

&#x2F;**
 * extend B2DPlayer with additional font drawing
 *&#x2F;
CG.B2DPlayer.extend(&#x27;B2DLeftPlayer&#x27;, {
    init: function (world, name, image, jsonpoly, x, y, scale, stat, bullet) {
        this._super(world, name, image, jsonpoly, x, y, scale, stat, bullet)

        this.shadow = new CG.Sprite(Game.asset.getImageByName(&#x27;beachvolleyball-shadow&#x27;), new CG.Point((this.body.GetPosition().x + 58) * this.scale, Game.height - 50))
        this.shadow.xscale = 1.3
        this.shadow.name = &#x27;beachvolleyball-shadow&#x27;
        mainlayer.addElement(this.shadow)
    },
    draw: function () {
        this._super()
        this.font.draw(&#x27;&#x27; + this.points, this.offhor, this.offver)

    },
    update: function () {
        this._super()
        this.shadow.position.x = (this.body.GetPosition().x + 1.45) * this.scale
    }
})

&#x2F;**
 * extend B2DCircle adding custom bodyDef&#x2F;fixDef and control arrow (sprite)
 *&#x2F;
CG.B2DCircle.extend(&#x27;B2DBall&#x27;, {
    init: function (world, name, image, radius, x, y, scale, stat) {
        this.bodyDef = new b2BodyDef &#x2F;&#x2F;&#x27;overwrite&#x27; class bodyDef
        this.bodyDef.allowSleep = true
        this.bodyDef.awake = true
        this.bodyDef.bullet = true

        this.fixDef = new b2FixtureDef &#x2F;&#x2F;&#x27;overwrite&#x27; class fixDef
        this.fixDef.density = 2.5
        this.fixDef.friction = 0.2
        this.fixDef.restitution = 0.55

        this._super(world, name, image, radius, x, y, scale, stat)


        this.arrow = new CG.Sprite(Game.asset.getImageByName(&#x27;arrow&#x27;), new CG.Point(this.body.GetPosition().x * this.scale, 15))
        this.arrow.name = &#x27;arrow&#x27;
        mainlayer.addElement(this.arrow)
        this.shadow = new CG.Sprite(Game.asset.getImageByName(&#x27;beachvolleyball-shadow&#x27;), new CG.Point(this.body.GetPosition().x * this.scale, Game.height - 50))
        this.shadow.name = &#x27;beachvolleyball-shadow&#x27;
        mainlayer.addElement(this.shadow)

    },
    update: function () {
        this._super()
        this.arrow.position.x = this.body.GetPosition().x * this.scale
        this.shadow.position.x = this.body.GetPosition().x * this.scale
    }
})


&#x2F;&#x2F; the Game object
Game = (function () {
    var Game = {
        fps: 60,
        width: gw,
        height: gh,
        width2: gw &#x2F; 2,
        height2: gh &#x2F; 2,
        bound: new CG.Bound(0, 0, gw, gh).setName(&#x27;game&#x27;),
        b_canvas: false,
        b_ctx: false,
        asset: new CG.MediaAsset(&#x27;media&#x2F;img&#x2F;splash3.jpg&#x27;), &#x2F;&#x2F;initialize media asset with background image
        director: new CG.Director(),
        delta: new CG.Delta(60),
        preload: function () {

            &#x2F;&#x2F;sfx
            sfxIntro = new buzz.sound(&quot;media&#x2F;sfx&#x2F;blobby-intro&quot;, {
                formats:[ &quot;ogg&quot;, &quot;mp3&quot;&#x2F;*, &quot;aac&quot;, &quot;wav&quot;*&#x2F; ],
                preload:true,
                autoplay:true,
                loop:true
            });
            sfxCrowd = new buzz.sound(&quot;media&#x2F;sfx&#x2F;blobby-crowd&quot;, {
                formats:[ &quot;ogg&quot;, &quot;mp3&quot;&#x2F;*, &quot;aac&quot;, &quot;wav&quot;*&#x2F; ],
                preload:true,
                autoplay:false,
                loop:false
            });
            sfxWhistle = new buzz.sound(&quot;media&#x2F;sfx&#x2F;blobby-whistle&quot;, {
                formats:[ &quot;ogg&quot;, &quot;mp3&quot;&#x2F;*, &quot;aac&quot;, &quot;wav&quot;*&#x2F; ],
                preload:true,
                autoplay:false,
                loop:false
            });
            sfxNet = new buzz.sound(&quot;media&#x2F;sfx&#x2F;blobby-net&quot;, {
                formats:[ &quot;ogg&quot;, &quot;mp3&quot;&#x2F;*, &quot;aac&quot;, &quot;wav&quot;*&#x2F; ],
                preload:true,
                autoplay:false,
                loop:false
            });



            &#x2F;&#x2F;canvas for ouput
            canvas = document.getElementById(&quot;canvas&quot;)
            ctx = canvas.getContext(&quot;2d&quot;)

            &#x2F;&#x2F;frame buffer
            Game.b_canvas = document.createElement(&#x27;canvas&#x27;)
            Game.b_ctx = Game.b_canvas.getContext(&#x27;2d&#x27;)
            Game.b_canvas.width = Game.bound.width
            Game.b_canvas.height = Game.bound.height

            &#x2F;&#x2F;Asset preloading font files
            Game.asset.addFont(&#x27;media&#x2F;font&#x2F;small.txt&#x27;, &#x27;small&#x27;, &#x27;small&#x27;)

                &#x2F;&#x2F;physics engine
                .addJson(&#x27;media&#x2F;img&#x2F;blobbies.json&#x27;, &#x27;blobbies&#x27;)

                .addImage(&#x27;media&#x2F;img&#x2F;glowball-50.png&#x27;, &#x27;glowball&#x27;)

                .addImage(&#x27;media&#x2F;img&#x2F;blobby-egg-left.png&#x27;, &#x27;blobby-egg-left&#x27;)
                .addImage(&#x27;media&#x2F;img&#x2F;blobby-egg-right.png&#x27;, &#x27;blobby-egg-right&#x27;)

                .addImage(&#x27;media&#x2F;img&#x2F;blobby-back.png&#x27;, &#x27;blobby-back&#x27;)
                .addImage(&#x27;media&#x2F;img&#x2F;blobby-ctrl-right.png&#x27;, &#x27;ctrl-right&#x27;)
                .addImage(&#x27;media&#x2F;img&#x2F;blobby-ctrl-left.png&#x27;, &#x27;ctrl-left&#x27;)
                .addImage(&#x27;media&#x2F;img&#x2F;arrow-25.png&#x27;, &#x27;arrow&#x27;)
                .addImage(&#x27;media&#x2F;img&#x2F;beachvolleyball.png&#x27;, &#x27;beachvolleyball&#x27;)
                .addImage(&#x27;media&#x2F;img&#x2F;beachvolleyball-shadow.png&#x27;, &#x27;beachvolleyball-shadow&#x27;)

                &#x2F;&#x2F;font
                .addImage(&#x27;media&#x2F;font&#x2F;blobby-points.png&#x27;, &#x27;blobby-points&#x27;)
                .addFont(&#x27;media&#x2F;font&#x2F;blobby-points.txt&#x27;, &#x27;blobby-points&#x27;)

                &#x2F;&#x2F;texturepacker
                .addImage(&#x27;media&#x2F;img&#x2F;texturepacker.png&#x27;, &#x27;texturepacker&#x27;)
                .addJson(&#x27;media&#x2F;img&#x2F;texturepacker.json&#x27;, &#x27;texturepacker-json&#x27;)

                .startPreLoad()
        },
        create: function () {

            &#x2F;&#x2F;create texturepacker image in asset
            tp.loadJson(Game.asset.getJsonByName(&#x27;texturepacker-json&#x27;))

            &#x2F;&#x2F;put the texturepacker TPImages to the asset
            Game.asset.images.push.apply(Game.asset.images, tp.getTPImages())

            small = new CG.Font().loadFont(Game.asset.getFontByName(&#x27;small&#x27;))

            &#x2F;&#x2F;screen and layer
            mainscreen = new CG.Screen(&#x27;mainscreen&#x27;)
            mainlayer = new CG.Layer(&#x27;mainlayer&#x27;)

            back = new CG.Sprite(Game.asset.getImageByName(&#x27;blobby-back&#x27;), new CG.Point(400, 240))
            back.name = &#x27;back&#x27;
            mainlayer.addElement(back)


            ctrlleft = new CG.Sprite(Game.asset.getImageByName(&#x27;ctrl-left&#x27;), new CG.Point(0 + 40, Game.height - 30))
            ctrlleft.name = &#x27;ctrlleft&#x27;
            mainlayer.addElement(ctrlleft)
            ctrlright = new CG.Sprite(Game.asset.getImageByName(&#x27;ctrl-right&#x27;), new CG.Point(Game.width - 40, Game.height - 30))
            ctrlright.name = &#x27;ctrlright&#x27;
            mainlayer.addElement(ctrlright)


            var opt = {sleep: false}
            &#x2F;&#x2F;create Box2D World
            b2world = new CG.B2DTestbed(&#x27;box2d-world&#x27;, opt)

            &#x2F;&#x2F;add it to a CGLayer
            mainlayer.addElement(b2world)

            &#x2F;&#x2F;add screen to Director
            Game.director.addScreen(mainscreen.addLayer(mainlayer))

            renderStats = new Stats()
            document.body.appendChild(renderStats.domElement)

            document.onkeydown = function (evt) {
                var keyCode = evt.keyCode

                if (keyCode == 71) { &#x2F;&#x2F;g
                    b = b2world.getBodyAt(mousex, mousey)
                    console.log([b.m_userData.name, b.m_userData.uid, b.m_islandIndex])
                }
                if (keyCode == 73) { &#x2F;&#x2F;i
                    body = b2world.getBodyAt(mousex, mousey)
                    b2world.applyImpulse(body, 270, 200)
                }


                if (keyCode == 65) { &#x2F;&#x2F; a - left
                    leftplayer.addVelocity(new b2Vec2(-3, 0))
                }
                if (keyCode == 87) { &#x2F;&#x2F; w - up
                    if (leftplayer.jump == false) {
                        &#x2F;&#x2F;self.applyImpulse(270, self.hor_impulse)
                        leftplayer.addVelocity(new b2Vec2(0, -9))
                        leftplayer.jump = true
                    }
                }
                if (keyCode == 68) { &#x2F;&#x2F; d - right
                    leftplayer.addVelocity(new b2Vec2(3, 0))
                }


                if (keyCode == 37) { &#x2F;&#x2F;left
                    rightplayer.addVelocity(new b2Vec2(-3, 0))

                }
                if (keyCode == 38) { &#x2F;&#x2F;up
                    if (rightplayer.jump == false) {
                        &#x2F;&#x2F;self.applyImpulse(270, self.hor_impulse)
                        rightplayer.addVelocity(new b2Vec2(0, -9))
                        rightplayer.jump = true
                    }
                }
                if (keyCode == 39) { &#x2F;&#x2F;right
                    rightplayer.addVelocity(new b2Vec2(3, 0))
                }

            };


            Game.loop()
        },
        loop: function () {
            requestAnimationFrame(Game.loop);
            if (Game.asset.ready == true) {
                Game.anim1();
            }
        },
        anim1: function () {
            Game.update()
            Game.draw()
        },
        update: function () {
            &#x2F;&#x2F;update here what ever you want
            Game.director.update()

            if (startleft == true) {
                ball.body.SetPosition(new b2Vec2(4, 4.5))
                &#x2F;&#x2F;ball.body.SetAngularVelocity(0)
                ball.body.SetSleepingAllowed()
                ball.body.SetAngularVelocity(0)
            } else if (startright == true) {
                ball.body.SetPosition(new b2Vec2(16, 4.5))
                &#x2F;&#x2F;ball.body.SetAngularVelocity(0)
                ball.body.SetSleepingAllowed()
                ball.body.SetAngularVelocity(0)
            }
        },
        draw: function () {
            ctx.clearRect(0, 0, Game.bound.width, Game.bound.height)

            &#x2F;&#x2F;draw all elements that the director has
            Game.director.draw()

            &#x2F;&#x2F;text stuff
            var dummytext = &#x27;Tribute to blobby ;o)&#x27;
            small.draw(dummytext, Game.width2 - (small.getTextWidth(dummytext) &#x2F; 2), 10)

            &#x2F;&#x2F; draw Game.b_canvas to the canvas
            ctx.drawImage(Game.b_canvas, 0, 0)

            &#x2F;&#x2F; clear the Game.b_canvas
            Game.b_ctx.clearRect(0, 0, Game.bound.width, Game.bound.height)

            renderStats.update();
        },
        touchinit: function () {
        },
        touchhandler: function () {
        }
    }

    return Game
}())
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="..&#x2F;assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="..&#x2F;assets/js/yui-prettify.js"></script>
<script src="..&#x2F;assets/../api.js"></script>
<script src="..&#x2F;assets/js/api-filter.js"></script>
<script src="..&#x2F;assets/js/api-list.js"></script>
<script src="..&#x2F;assets/js/api-search.js"></script>
<script src="..&#x2F;assets/js/apidocs.js"></script>
</body>
</html>
